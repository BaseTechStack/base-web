import{_ as f,a as h,b as k}from"./DocsLayout.vue_vue_type_script_setup_true_lang-D4FaFzot.js";import{_ as v,a as w}from"./Card-dhBREXno.js";import{d as P,u as C,c as A,w as a,a as T,b as E,e,f as n,g as s,_ as z,r as R,o as x}from"./index-c5PrNzGP.js";const _={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},G={class:"space-y-12"},S={class:"grid gap-6 md:grid-cols-3"},I={class:"flex items-center space-x-2"},O={class:"space-y-3"},U={class:"text-sm text-gray-600 dark:text-gray-300"},D={class:"flex items-center space-x-2"},L={class:"space-y-3"},j={class:"text-sm text-gray-600 dark:text-gray-300"},M={class:"flex items-center space-x-2"},B={class:"space-y-3"},H={class:"text-sm text-gray-600 dark:text-gray-300"},N={class:"space-y-6"},J={class:"flex items-center space-x-2"},F={class:"space-y-4"},q={class:"flex items-start space-x-3"},W={class:"text-sm text-gray-600 dark:text-gray-300"},X={class:"flex items-center space-x-2"},K={class:"space-y-4"},V={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},$={class:"flex items-center justify-between mb-2"},Y={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},Z={class:"flex items-center justify-between mb-2"},Q={class:"space-y-6"},ee={class:"flex items-center space-x-2"},te={class:"grid gap-4 md:grid-cols-2"},se={class:"space-y-3"},ne={class:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},ae={class:"w-8 h-8 bg-red-500 rounded flex items-center justify-center"},re={class:"text-sm text-gray-600 dark:text-gray-300"},oe={class:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},le={class:"w-8 h-8 bg-gray-900 rounded flex items-center justify-center"},ie={class:"text-sm text-gray-600 dark:text-gray-300"},de={class:"space-y-3"},ue={class:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},pe={class:"w-8 h-8 bg-blue-600 rounded flex items-center justify-center"},ce={class:"text-sm text-gray-600 dark:text-gray-300"},xe={class:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},ge={class:"w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded flex items-center justify-center"},me={class:"flex items-center space-x-2"},be={class:"space-y-4"},ye={class:"text-sm text-gray-600 dark:text-gray-300"},fe={class:"relative bg-gray-50 dark:bg-gray-800 rounded-lg p-4 overflow-x-auto"},he={class:"flex items-center justify-between mb-2"},ke={class:"space-y-6"},ve={class:"flex items-center space-x-2"},we={class:"flex items-center space-x-2"},Pe={class:"space-y-4"},Ce={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-4 overflow-x-auto"},Ae={class:"flex items-center justify-between mb-2"},Te={class:"flex items-center space-x-2"},Ee={class:"space-y-4"},ze={class:"grid gap-4 md:grid-cols-2"},Re={class:"relative bg-gray-50 dark:bg-gray-800 rounded-lg p-3 overflow-x-auto"},_e={class:"flex items-center justify-between mb-2"},Ge={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},Se={class:"flex items-center justify-between mb-2"},Ie={class:"grid gap-6 md:grid-cols-2"},Oe={class:"flex items-center space-x-2"},Ue={class:"text-sm text-gray-600 dark:text-gray-300 space-y-2"},De={class:"flex items-center space-x-2"},Le={class:"flex items-center space-x-2"},je={class:"flex items-center space-x-2"},Me={class:"flex items-center space-x-2"},Be={class:"flex items-center space-x-2"},He={class:"text-sm text-gray-600 dark:text-gray-300 space-y-2"},Ne={class:"flex items-center space-x-2"},Je={class:"flex items-center space-x-2"},Fe={class:"flex items-center space-x-2"},qe={class:"flex items-center space-x-2"},We={class:"flex items-center space-x-2"},Xe={class:"text-sm text-gray-600 dark:text-gray-300 space-y-2"},Ke={class:"flex items-center space-x-2"},Ve={class:"flex items-center space-x-2"},$e={class:"flex items-center space-x-2"},Ye={class:"flex items-center space-x-2"},Ze={class:"flex items-center space-x-2"},Qe={class:"text-sm text-gray-600 dark:text-gray-300 space-y-2"},et={class:"flex items-center space-x-2"},tt={class:"flex items-center space-x-2"},st={class:"flex items-center space-x-2"},nt={class:"flex items-center space-x-2"},at={class:"space-y-6"},rt={class:"flex items-center space-x-2"},ot={class:"space-y-4"},lt={class:"grid gap-4 md:grid-cols-2"},it={class:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg"},dt={class:"font-medium text-blue-900 dark:text-blue-100 mb-2 flex items-center"},ut={class:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg"},pt={class:"font-medium text-green-900 dark:text-green-100 mb-2 flex items-center"},ct={class:"p-4 bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg"},xt={class:"font-medium text-purple-900 dark:text-purple-100 mb-2 flex items-center"},gt={class:"p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg"},mt={class:"font-medium text-orange-900 dark:text-orange-100 mb-2 flex items-center"},bt={class:"flex items-center space-x-2"},yt={class:"space-y-4"},ft={class:"p-4 bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 border border-green-200 dark:border-green-800 rounded-lg"},ht={class:"font-medium text-green-900 dark:text-green-100 mb-2 flex items-center"},kt={class:"text-sm text-green-800 dark:text-green-200 mb-3"},vt={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},wt={class:"flex items-center justify-between mb-2"},Pt={class:"space-y-4"},Ct={class:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},At={class:"grid gap-3 md:grid-cols-2"},Tt={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},Et={class:"flex items-center justify-between mb-2"},zt={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},Rt={class:"flex items-center justify-between mb-2"},_t={class:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},Gt={class:"grid gap-3 md:grid-cols-2"},St={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},It={class:"flex items-center justify-between mb-2"},Ot={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},Ut={class:"flex items-center justify-between mb-2"},Dt={class:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},Lt={class:"grid gap-3 md:grid-cols-2"},jt={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},Mt={class:"flex items-center justify-between mb-2"},Bt={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},Ht={class:"flex items-center justify-between mb-2"},Nt={class:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},Jt={class:"grid gap-3 md:grid-cols-2"},Ft={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},qt={class:"flex items-center justify-between mb-2"},Wt={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},Xt={class:"flex items-center justify-between mb-2"},Kt={class:"flex items-center space-x-2"},Vt={class:"space-y-4"},$t={class:"grid gap-4 md:grid-cols-2"},Yt={class:"space-y-3"},Zt={class:"space-y-2 text-sm"},Qt={class:"flex items-center justify-between p-2 bg-green-50 dark:bg-green-900/20 rounded"},es={class:"flex items-center justify-between p-2 bg-blue-50 dark:bg-blue-900/20 rounded"},ts={class:"flex items-center justify-between p-2 bg-purple-50 dark:bg-purple-900/20 rounded"},ss={class:"flex items-center justify-between p-2 bg-orange-50 dark:bg-orange-900/20 rounded"},ns={class:"flex items-center justify-between p-2 bg-red-50 dark:bg-red-900/20 rounded"},as={class:"space-y-3"},rs={class:"space-y-2 text-sm"},os={class:"flex items-center justify-between p-2 bg-green-50 dark:bg-green-900/20 rounded"},ls={class:"flex items-center justify-between p-2 bg-purple-50 dark:bg-purple-900/20 rounded"},is={class:"flex items-center justify-between p-2 bg-red-50 dark:bg-red-900/20 rounded"},ds={class:"flex items-center justify-between p-2 bg-blue-50 dark:bg-blue-900/20 rounded"},us={class:"flex items-center space-x-2"},ps={class:"space-y-4"},cs={class:"space-y-4"},xs={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},gs={class:"flex items-center justify-between mb-2"},ms={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},bs={class:"flex items-center justify-between mb-2"},ys={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-3 overflow-x-auto"},fs={class:"flex items-center justify-between mb-2"},hs={class:"space-y-6"},ks={class:"flex items-center space-x-2"},vs={class:"space-y-4"},ws={class:"relative bg-gray-900 dark:bg-gray-950 rounded-lg p-4 overflow-x-auto"},Ps={class:"flex items-center justify-between mb-2"},zs=P({__name:"authentication",setup(Cs){const{copy:g,copied:m,isSupported:b}=C();async function l(c,t){if(!b.value){console.error("Clipboard API not supported");return}await g(c);const r=t?.target;if(r&&m.value){const d=r.textContent;r.textContent="Copied!",setTimeout(()=>{r.textContent=d},2e3)}}return(c,t)=>{const r=z,d=h,i=v,p=w,u=k,y=R("prism");return x(),A(f,null,{default:a(()=>[T((x(),E("div",_,[t[200]||(t[200]=e("div",{class:"mb-8"},[e("h1",{class:"text-4xl font-bold text-gray-900 dark:text-white mb-4"},"Authentication & Authorization"),e("p",{class:"text-xl text-gray-600 dark:text-gray-300"}," Understand Base Framework's comprehensive authentication system with built-in OAuth, JWT tokens, and role-based access control. ")],-1)),e("div",G,[e("section",null,[t[31]||(t[31]=e("h2",{class:"text-3xl font-bold text-gray-900 dark:text-white mb-6"},"Core Authentication Modules",-1)),t[32]||(t[32]=e("p",{class:"text-gray-600 dark:text-gray-300 mb-6"}," Base Framework comes with three built-in core modules that work together to provide complete authentication and authorization: ",-1)),e("div",S,[n(i,null,{header:a(()=>[e("div",I,[n(r,{name:"i-lucide-user-check",class:"h-5 w-5 text-blue-500"}),t[19]||(t[19]=e("span",{class:"font-semibold"},"Authentication",-1))])]),default:a(()=>[e("div",O,[e("p",U,[t[21]||(t[21]=s(" Located at ",-1)),n(d,{size:"sm"},{default:a(()=>t[20]||(t[20]=[s("core/app/authentication/",-1)])),_:1,__:[20]})]),t[22]||(t[22]=e("ul",{class:"text-sm text-gray-600 dark:text-gray-300 space-y-1"},[e("li",null,"• JWT token generation"),e("li",null,"• User login/logout"),e("li",null,"• Password hashing"),e("li",null,"• Token validation"),e("li",null,"• Session management")],-1))])]),_:1}),n(i,null,{header:a(()=>[e("div",D,[n(r,{name:"i-lucide-key",class:"h-5 w-5 text-green-500"}),t[23]||(t[23]=e("span",{class:"font-semibold"},"OAuth",-1))])]),default:a(()=>[e("div",L,[e("p",j,[t[25]||(t[25]=s(" Located at ",-1)),n(d,{size:"sm"},{default:a(()=>t[24]||(t[24]=[s("core/app/oauth/",-1)])),_:1,__:[24]})]),t[26]||(t[26]=e("ul",{class:"text-sm text-gray-600 dark:text-gray-300 space-y-1"},[e("li",null,"• Google OAuth integration"),e("li",null,"• GitHub OAuth support"),e("li",null,"• Facebook login"),e("li",null,"• Custom OAuth providers"),e("li",null,"• Social account linking")],-1))])]),_:1}),n(i,null,{header:a(()=>[e("div",M,[n(r,{name:"i-lucide-shield",class:"h-5 w-5 text-purple-500"}),t[27]||(t[27]=e("span",{class:"font-semibold"},"Authorization",-1))])]),default:a(()=>[e("div",B,[e("p",H,[t[29]||(t[29]=s(" Located at ",-1)),n(d,{size:"sm"},{default:a(()=>t[28]||(t[28]=[s("core/app/authorization/",-1)])),_:1,__:[28]})]),t[30]||(t[30]=e("ul",{class:"text-sm text-gray-600 dark:text-gray-300 space-y-1"},[e("li",null,"• Role-based access control"),e("li",null,"• Permission management"),e("li",null,"• Route protection"),e("li",null,"• API key authentication"),e("li",null,"• Middleware integration")],-1))])]),_:1})])]),e("section",null,[t[51]||(t[51]=e("h2",{class:"text-3xl font-bold text-gray-900 dark:text-white mb-6"},"Authentication Flow",-1)),e("div",N,[n(i,null,{header:a(()=>[e("div",J,[n(r,{name:"i-lucide-flow-chart",class:"h-4 w-4 text-blue-500"}),t[33]||(t[33]=e("span",{class:"font-semibold"},"JWT Authentication Process",-1))])]),default:a(()=>[e("div",F,[e("div",q,[t[39]||(t[39]=e("div",{class:"w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold"},"1",-1)),e("div",null,[t[38]||(t[38]=e("h5",{class:"font-medium text-gray-900 dark:text-white"},"User Registration/Login",-1)),e("p",W,[t[36]||(t[36]=s("POST to ",-1)),n(d,{size:"sm"},{default:a(()=>t[34]||(t[34]=[s("/api/auth/login",-1)])),_:1,__:[34]}),t[37]||(t[37]=s(" or ",-1)),n(d,{size:"sm"},{default:a(()=>t[35]||(t[35]=[s("/api/auth/register",-1)])),_:1,__:[35]})])])]),t[40]||(t[40]=e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center text-xs font-bold"},"2"),e("div",null,[e("h5",{class:"font-medium text-gray-900 dark:text-white"},"Credential Validation"),e("p",{class:"text-sm text-gray-600 dark:text-gray-300"},"Password verification using bcrypt hashing")])],-1)),t[41]||(t[41]=e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-6 h-6 bg-purple-500 text-white rounded-full flex items-center justify-center text-xs font-bold"},"3"),e("div",null,[e("h5",{class:"font-medium text-gray-900 dark:text-white"},"JWT Token Generation"),e("p",{class:"text-sm text-gray-600 dark:text-gray-300"},"Signed JWT with user ID, roles, and expiration")])],-1)),t[42]||(t[42]=e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-6 h-6 bg-orange-500 text-white rounded-full flex items-center justify-center text-xs font-bold"},"4"),e("div",null,[e("h5",{class:"font-medium text-gray-900 dark:text-white"},"Token Storage"),e("p",{class:"text-sm text-gray-600 dark:text-gray-300"},"Client stores token in localStorage or httpOnly cookie")])],-1))])]),_:1}),n(i,null,{header:a(()=>[e("div",X,[n(r,{name:"i-lucide-api",class:"h-4 w-4 text-green-500"}),t[43]||(t[43]=e("span",{class:"font-semibold"},"API Authentication Example",-1))])]),default:a(()=>[e("div",K,[e("div",null,[t[46]||(t[46]=e("h5",{class:"font-medium text-gray-900 dark:text-white mb-2"},"Login Request",-1)),e("div",V,[e("div",$,[t[44]||(t[44]=e("span",{class:"text-xs text-gray-400"},"cURL Example",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[0]||(t[0]=o=>l(`curl -X POST http://localhost:8100/api/auth/login \\
  -H "Content-Type: application/json" \\
  -d '{
    "email": "user@example.com",
    "password": "securepassword"
  }'`,o))}," Copy ")]),t[45]||(t[45]=e("pre",{class:"text-sm text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-blue-400"},"curl"),s(` -X POST http://localhost:8100/api/auth/login \\\\
  -H `),e("span",{class:"text-green-400"},'"Content-Type: application/json"'),s(` \\\\
  -d `),e("span",{class:"text-yellow-400"},`'{
    "email": "user@example.com",
    "password": "securepassword"
  }'`)])],-1))])]),t[50]||(t[50]=e("div",null,[e("h5",{class:"font-medium text-gray-900 dark:text-white mb-2"},"Response"),e("div",{class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3"},[e("pre",{class:"text-sm text-gray-700 dark:text-gray-300"},[e("code",null,`{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 1,
    "email": "user@example.com",
    "first_name": "John",
    "last_name": "Doe"
  },
  "expires_at": "2024-12-01T12:00:00Z"
}`)])])],-1)),e("div",null,[t[49]||(t[49]=e("h5",{class:"font-medium text-gray-900 dark:text-white mb-2"},"Authenticated API Call",-1)),e("div",Y,[e("div",Z,[t[47]||(t[47]=e("span",{class:"text-xs text-gray-400"},"Using JWT Token",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[1]||(t[1]=o=>l(`curl -X GET http://localhost:8100/api/posts \\
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."`,o))}," Copy ")]),t[48]||(t[48]=e("pre",{class:"text-sm text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-blue-400"},"curl"),s(` -X GET http://localhost:8100/api/posts \\\\
  -H `),e("span",{class:"text-green-400"},'"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."')])],-1))])])])]),_:1})])]),e("section",null,[t[69]||(t[69]=e("h2",{class:"text-3xl font-bold text-gray-900 dark:text-white mb-6"},"OAuth Integration",-1)),e("div",Q,[n(p,{color:"blue",variant:"soft",title:"Social Login Support",description:"Base Framework's OAuth module supports multiple providers out of the box with automatic account linking and profile synchronization."}),n(i,null,{header:a(()=>[e("div",ee,[n(r,{name:"i-lucide-users",class:"h-4 w-4 text-blue-500"}),t[52]||(t[52]=e("span",{class:"font-semibold"},"Supported OAuth Providers",-1))])]),default:a(()=>[e("div",te,[e("div",se,[e("div",ne,[e("div",ae,[n(r,{name:"i-lucide-chrome",class:"h-4 w-4 text-white"})]),e("div",null,[t[55]||(t[55]=e("h5",{class:"font-medium text-gray-900 dark:text-white"},"Google OAuth",-1)),e("p",re,[t[54]||(t[54]=s("GET ",-1)),n(d,{size:"sm"},{default:a(()=>t[53]||(t[53]=[s("/api/oauth/google",-1)])),_:1,__:[53]})])])]),e("div",oe,[e("div",le,[n(r,{name:"i-lucide-github",class:"h-4 w-4 text-white"})]),e("div",null,[t[58]||(t[58]=e("h5",{class:"font-medium text-gray-900 dark:text-white"},"GitHub OAuth",-1)),e("p",ie,[t[57]||(t[57]=s("GET ",-1)),n(d,{size:"sm"},{default:a(()=>t[56]||(t[56]=[s("/api/oauth/github",-1)])),_:1,__:[56]})])])])]),e("div",de,[e("div",ue,[e("div",pe,[n(r,{name:"i-lucide-facebook",class:"h-4 w-4 text-white"})]),e("div",null,[t[61]||(t[61]=e("h5",{class:"font-medium text-gray-900 dark:text-white"},"Facebook OAuth",-1)),e("p",ce,[t[60]||(t[60]=s("GET ",-1)),n(d,{size:"sm"},{default:a(()=>t[59]||(t[59]=[s("/api/oauth/facebook",-1)])),_:1,__:[59]})])])]),e("div",xe,[e("div",ge,[n(r,{name:"i-lucide-plus",class:"h-4 w-4 text-white"})]),t[62]||(t[62]=e("div",null,[e("h5",{class:"font-medium text-gray-900 dark:text-white"},"Custom Provider"),e("p",{class:"text-sm text-gray-600 dark:text-gray-300"},"Easily add new providers")],-1))])])])]),_:1}),n(i,null,{header:a(()=>[e("div",me,[n(r,{name:"i-lucide-settings",class:"h-4 w-4 text-purple-500"}),t[63]||(t[63]=e("span",{class:"font-semibold"},"OAuth Configuration",-1))])]),default:a(()=>[e("div",be,[e("p",ye,[t[65]||(t[65]=s(" Configure OAuth providers in your ",-1)),n(d,{size:"sm"},{default:a(()=>t[64]||(t[64]=[s(".env",-1)])),_:1,__:[64]}),t[66]||(t[66]=s(" file: ",-1))]),e("div",fe,[e("div",he,[t[67]||(t[67]=e("span",{class:"text-xs text-gray-500"},".env Configuration",-1)),e("button",{class:"copy-button text-xs text-gray-500 hover:text-gray-700 px-2 py-1 rounded border border-gray-300 hover:border-gray-400 transition-colors",onClick:t[2]||(t[2]=o=>l(`# Google OAuth
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_REDIRECT_URL=http://localhost:8100/api/oauth/google/callback

# GitHub OAuth
GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret
GITHUB_REDIRECT_URL=http://localhost:8100/api/oauth/github/callback`,o))}," Copy ")]),t[68]||(t[68]=e("pre",{class:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-green-600"},"# Google OAuth"),s(`
`),e("span",{class:"text-blue-600"},"GOOGLE_CLIENT_ID"),s(`=your_google_client_id
`),e("span",{class:"text-blue-600"},"GOOGLE_CLIENT_SECRET"),s(`=your_google_client_secret
`),e("span",{class:"text-blue-600"},"GOOGLE_REDIRECT_URL"),s(`=http://localhost:8100/api/oauth/google/callback

`),e("span",{class:"text-green-600"},"# GitHub OAuth"),s(`
`),e("span",{class:"text-blue-600"},"GITHUB_CLIENT_ID"),s(`=your_github_client_id
`),e("span",{class:"text-blue-600"},"GITHUB_CLIENT_SECRET"),s(`=your_github_client_secret
`),e("span",{class:"text-blue-600"},"GITHUB_REDIRECT_URL"),s("=http://localhost:8100/api/oauth/github/callback")])],-1))])])]),_:1})])]),e("section",null,[t[85]||(t[85]=e("h2",{class:"text-3xl font-bold text-gray-900 dark:text-white mb-6"},"Authorization & Permissions",-1)),e("div",ke,[n(i,null,{header:a(()=>[e("div",ve,[n(r,{name:"i-lucide-shield-check",class:"h-4 w-4 text-green-500"}),t[70]||(t[70]=e("span",{class:"font-semibold"},"Role-Based Access Control (RBAC)",-1))])]),default:a(()=>[t[71]||(t[71]=e("div",{class:"space-y-4"},[e("p",{class:"text-sm text-gray-600 dark:text-gray-300"}," Base Framework includes a flexible RBAC system that allows you to define roles and permissions for your application: "),e("div",{class:"grid gap-4 md:grid-cols-3"},[e("div",{class:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},[e("h5",{class:"font-medium text-blue-900 dark:text-blue-100 mb-2"},"👤 Users"),e("p",{class:"text-sm text-blue-800 dark:text-blue-200"},"Assigned one or more roles")]),e("div",{class:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg"},[e("h5",{class:"font-medium text-green-900 dark:text-green-100 mb-2"},"🎭 Roles"),e("p",{class:"text-sm text-green-800 dark:text-green-200"},"Collections of permissions")]),e("div",{class:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg"},[e("h5",{class:"font-medium text-purple-900 dark:text-purple-100 mb-2"},"🔐 Permissions"),e("p",{class:"text-sm text-purple-800 dark:text-purple-200"},"Specific access rights")])])],-1))]),_:1,__:[71]}),n(i,null,{header:a(()=>[e("div",we,[n(r,{name:"i-lucide-route",class:"h-4 w-4 text-orange-500"}),t[72]||(t[72]=e("span",{class:"font-semibold"},"Route Protection",-1))])]),default:a(()=>[e("div",Pe,[t[75]||(t[75]=e("p",{class:"text-sm text-gray-600 dark:text-gray-300"}," Protect your API endpoints using middleware decorators: ",-1)),e("div",Ce,[e("div",Ae,[t[73]||(t[73]=e("span",{class:"text-xs text-gray-400"},"Go Code Example",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[3]||(t[3]=o=>l(`// Require authentication (basic auth middleware)
router.GET("/api/protected", controller.ProtectedEndpoint, authMiddleware)

// Require specific role
router.POST("/api/admin", controller.AdminEndpoint, authorization.HasRole("Administrator"))

// Require specific permission  
router.DELETE("/api/posts/:id", controller.DeletePost, authorization.CanAccess("delete", "Post", "id"))

// Multiple middleware combined
router.PUT("/api/posts/:id", controller.UpdatePost, 
  authMiddleware, 
  authorization.CanAccess("update", "Post", "id"))`,o))}," Copy ")]),t[74]||(t[74]=e("pre",{class:"text-sm text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-green-400"},"// Require authentication (basic auth middleware)"),s(`
router.GET(`),e("span",{class:"text-yellow-400"},'"/api/protected"'),s(", controller.ProtectedEndpoint, "),e("span",{class:"text-blue-400"},"authMiddleware"),s(`)

`),e("span",{class:"text-green-400"},"// Require specific role"),s(`
router.POST(`),e("span",{class:"text-yellow-400"},'"/api/admin"'),s(", controller.AdminEndpoint, "),e("span",{class:"text-purple-400"},'authorization.HasRole("Administrator")'),s(`)

`),e("span",{class:"text-green-400"},"// Require specific permission"),s(`  
router.DELETE(`),e("span",{class:"text-yellow-400"},'"/api/posts/:id"'),s(", controller.DeletePost, "),e("span",{class:"text-purple-400"},'authorization.CanAccess("delete", "Post", "id")'),s(`)

`),e("span",{class:"text-green-400"},"// Multiple middleware combined"),s(`
router.PUT(`),e("span",{class:"text-yellow-400"},'"/api/posts/:id"'),s(`, controller.UpdatePost, 
  `),e("span",{class:"text-blue-400"},"authMiddleware"),s(`, 
  `),e("span",{class:"text-purple-400"},'authorization.CanAccess("update", "Post", "id")'),s(")")])],-1))])])]),_:1}),n(i,null,{header:a(()=>[e("div",Te,[n(r,{name:"i-lucide-key-round",class:"h-4 w-4 text-red-500"}),t[76]||(t[76]=e("span",{class:"font-semibold"},"API Key Authentication",-1))])]),default:a(()=>[e("div",Ee,[t[83]||(t[83]=e("p",{class:"text-sm text-gray-600 dark:text-gray-300"},[s(" Base Framework supports multiple authentication methods. "),e("strong",null,"Bearer tokens (JWT) are the default for all generated modules"),s(", while API keys provide additional flexibility for service-to-service communication: ")],-1)),t[84]||(t[84]=e("div",{class:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"},[e("h5",{class:"font-medium text-blue-900 dark:text-blue-100 mb-2"},"🔑 Authentication Methods in Base Framework"),e("div",{class:"grid gap-3 md:grid-cols-2 text-sm"},[e("div",null,[e("strong",{class:"text-blue-900 dark:text-blue-100"},"Bearer Token (JWT) - Default"),e("ul",{class:"text-blue-800 dark:text-blue-200 mt-1 space-y-1"},[e("li",null,[s("• Header: "),e("code",null,"Authorization: Bearer token")]),e("li",null,[s("• "),e("strong",null,"Default auth for generated modules")]),e("li",null,"• User sessions, temporary access"),e("li",null,"• Expires automatically"),e("li",null,"• Contains user context")])]),e("div",null,[e("strong",{class:"text-blue-900 dark:text-blue-100"},"API Key - Environment Variable"),e("ul",{class:"text-blue-800 dark:text-blue-200 mt-1 space-y-1"},[e("li",null,[s("• Header: "),e("code",null,"X-API-Key: key")]),e("li",null,[s("• "),e("strong",null,"Set via environment variable")]),e("li",null,"• Required for auth management operations"),e("li",null,"• Service-to-service communication"),e("li",null,"• Application-level access control")])])])],-1)),e("div",ze,[e("div",null,[t[79]||(t[79]=e("h5",{class:"font-medium text-gray-900 dark:text-white mb-2"},"Configure API Key",-1)),e("div",Re,[e("div",_e,[t[77]||(t[77]=e("span",{class:"text-xs text-gray-500"},".env Configuration",-1)),e("button",{class:"copy-button text-xs text-gray-500 hover:text-gray-700 px-2 py-1 rounded border border-gray-300 hover:border-gray-400 transition-colors",onClick:t[4]||(t[4]=o=>l(`# JWT secret key
JWT_SECRET=my_super_secret_key_123

# Send this key in the header of the request for endpoints that require it
API_KEY=api`,o))}," Copy ")]),t[78]||(t[78]=e("pre",{class:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-green-600"},"# JWT secret key"),s(`
`),e("span",{class:"text-blue-600"},"JWT_SECRET"),s(`=my_super_secret_key_123

`),e("span",{class:"text-green-600"},"# Send this key in the header of the request for endpoints that require it"),s(`
`),e("span",{class:"text-blue-600"},"API_KEY"),s("=api")])],-1))])]),e("div",null,[t[82]||(t[82]=e("h5",{class:"font-medium text-gray-900 dark:text-white mb-2"},"Use API Key in Requests",-1)),e("div",Ge,[e("div",Se,[t[80]||(t[80]=e("span",{class:"text-xs text-gray-400"},"X-API-Key Header",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[5]||(t[5]=o=>l(`curl -X GET http://localhost:8100/api/posts \\
  -H "X-API-Key: api"`,o))}," Copy ")]),t[81]||(t[81]=e("pre",{class:"text-sm text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-blue-400"},"curl"),s(` -X GET http://localhost:8100/api/posts \\\\
  -H `),e("span",{class:"text-green-400"},'"X-API-Key: api"')])],-1))])])])])]),_:1})])]),e("section",null,[t[106]||(t[106]=e("h2",{class:"text-3xl font-bold text-gray-900 dark:text-white mb-6"},"Security Features",-1)),e("div",Ie,[n(i,null,{header:a(()=>[e("div",Oe,[n(r,{name:"i-lucide-lock",class:"h-4 w-4 text-red-500"}),t[86]||(t[86]=e("span",{class:"font-semibold"},"Password Security",-1))])]),default:a(()=>[e("ul",Ue,[e("li",De,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[87]||(t[87]=e("span",null,"bcrypt hashing with salt rounds",-1))]),e("li",Le,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[88]||(t[88]=e("span",null,"Password strength validation",-1))]),e("li",je,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[89]||(t[89]=e("span",null,"Password reset flows",-1))]),e("li",Me,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[90]||(t[90]=e("span",null,"Account lockout protection",-1))])])]),_:1}),n(i,null,{header:a(()=>[e("div",Be,[n(r,{name:"i-lucide-timer",class:"h-4 w-4 text-blue-500"}),t[91]||(t[91]=e("span",{class:"font-semibold"},"Token Management",-1))])]),default:a(()=>[e("ul",He,[e("li",Ne,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[92]||(t[92]=e("span",null,"JWT with configurable expiration",-1))]),e("li",Je,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[93]||(t[93]=e("span",null,"Refresh token rotation",-1))]),e("li",Fe,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[94]||(t[94]=e("span",null,"Token blacklisting",-1))]),e("li",qe,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[95]||(t[95]=e("span",null,"Session management",-1))])])]),_:1}),n(i,null,{header:a(()=>[e("div",We,[n(r,{name:"i-lucide-shield-alert",class:"h-4 w-4 text-orange-500"}),t[96]||(t[96]=e("span",{class:"font-semibold"},"Rate Limiting",-1))])]),default:a(()=>[e("ul",Xe,[e("li",Ke,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[97]||(t[97]=e("span",null,"IP-based rate limiting",-1))]),e("li",Ve,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[98]||(t[98]=e("span",null,"User-based rate limiting",-1))]),e("li",$e,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[99]||(t[99]=e("span",null,"Endpoint-specific limits",-1))]),e("li",Ye,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[100]||(t[100]=e("span",null,"Sliding window algorithm",-1))])])]),_:1}),n(i,null,{header:a(()=>[e("div",Ze,[n(r,{name:"i-lucide-activity",class:"h-4 w-4 text-purple-500"}),t[101]||(t[101]=e("span",{class:"font-semibold"},"Audit & Monitoring",-1))])]),default:a(()=>[e("ul",Qe,[e("li",et,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[102]||(t[102]=e("span",null,"Login attempt logging",-1))]),e("li",tt,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[103]||(t[103]=e("span",null,"Permission change tracking",-1))]),e("li",st,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[104]||(t[104]=e("span",null,"Failed authentication alerts",-1))]),e("li",nt,[n(r,{name:"i-lucide-check",class:"h-4 w-4 text-green-500"}),t[105]||(t[105]=e("span",null,"Security event notifications",-1))])])]),_:1})])]),e("section",null,[t[194]||(t[194]=e("h2",{class:"text-3xl font-bold text-gray-900 dark:text-white mb-6"},"Authorization System",-1)),e("div",at,[n(p,{color:"purple",variant:"soft",title:"🔐 Comprehensive RBAC System",description:"Base Framework's authorization module provides a complete role-based access control system with fine-grained permissions, middleware protection, and frontend integration."}),n(i,null,{header:a(()=>[e("div",rt,[n(r,{name:"i-lucide-database",class:"h-4 w-4 text-blue-500"}),t[107]||(t[107]=e("span",{class:"font-semibold"},"Authorization Models",-1))])]),default:a(()=>[e("div",ot,[t[120]||(t[120]=e("p",{class:"text-sm text-gray-600 dark:text-gray-300"}," The authorization system consists of four main data models that work together: ",-1)),e("div",lt,[e("div",it,[e("h5",dt,[n(r,{name:"i-lucide-user-cog",class:"h-4 w-4 mr-2"}),t[108]||(t[108]=s(" Roles ",-1))]),t[109]||(t[109]=e("p",{class:"text-sm text-blue-800 dark:text-blue-200 mb-3"},"System and custom roles with hierarchical permissions",-1)),t[110]||(t[110]=e("div",{class:"text-xs text-blue-700 dark:text-blue-300 space-y-1"},[e("div",null,[s("• "),e("strong",null,"Owner"),s(" - Full system access")]),e("div",null,[s("• "),e("strong",null,"Administrator"),s(" - Admin privileges")]),e("div",null,[s("• "),e("strong",null,"Member"),s(" - Standard user access")]),e("div",null,[s("• "),e("strong",null,"External"),s(" - Limited external access")])],-1))]),e("div",ut,[e("h5",pt,[n(r,{name:"i-lucide-key",class:"h-4 w-4 mr-2"}),t[111]||(t[111]=s(" Permissions ",-1))]),t[112]||(t[112]=e("p",{class:"text-sm text-green-800 dark:text-green-200 mb-3"},"Specific action rights on resource types",-1)),t[113]||(t[113]=e("div",{class:"text-xs text-green-700 dark:text-green-300 space-y-1"},[e("div",null,[s("• "),e("strong",null,"Actions:"),s(" create, read, update, delete, list")]),e("div",null,[s("• "),e("strong",null,"Resources:"),s(" posts, users, projects, etc.")])],-1))]),e("div",ct,[e("h5",xt,[n(r,{name:"i-lucide-link",class:"h-4 w-4 mr-2"}),t[114]||(t[114]=s(" Role Permissions ",-1))]),t[115]||(t[115]=e("p",{class:"text-sm text-purple-800 dark:text-purple-200 mb-3"},"Links roles to their allowed permissions",-1)),t[116]||(t[116]=e("div",{class:"text-xs text-purple-700 dark:text-purple-300"},[e("div",null,"Many-to-many relationship mapping roles to specific permissions")],-1))]),e("div",gt,[e("h5",mt,[n(r,{name:"i-lucide-file-lock",class:"h-4 w-4 mr-2"}),t[117]||(t[117]=s(" Resource Permissions ",-1))]),t[118]||(t[118]=e("p",{class:"text-sm text-orange-800 dark:text-orange-200 mb-3"},"Fine-grained access to specific resources",-1)),t[119]||(t[119]=e("div",{class:"text-xs text-orange-700 dark:text-orange-300 space-y-1"},[e("div",null,[s("• "),e("strong",null,"Scopes:"),s(" own, team, all")]),e("div",null,"• Resource-specific overrides")],-1))])])])]),_:1}),n(i,null,{header:a(()=>[e("div",bt,[n(r,{name:"i-lucide-shield-check",class:"h-4 w-4 text-green-500"}),t[121]||(t[121]=e("span",{class:"font-semibold"},"Authorization Middleware in Controllers",-1))])]),default:a(()=>[e("div",yt,[t[160]||(t[160]=e("p",{class:"text-sm text-gray-600 dark:text-gray-300"}," Base Framework provides intuitive authorization middleware functions with clean, readable syntax: ",-1)),e("div",ft,[e("h5",ht,[n(r,{name:"i-lucide-sparkles",class:"h-4 w-4 mr-2"}),t[122]||(t[122]=s(" ✨ New Intuitive Syntax ",-1))]),e("p",kt,[t[124]||(t[124]=s(" Use the new ",-1)),n(d,{size:"sm"},{default:a(()=>t[123]||(t[123]=[s("Can()",-1)])),_:1,__:[123]}),t[125]||(t[125]=s(" functions for clear, readable authorization checks: ",-1))]),e("div",vt,[e("div",wt,[t[126]||(t[126]=e("span",{class:"text-xs text-gray-400"},"Clean Authorization Syntax",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[6]||(t[6]=o=>l(`import "authorization"

func (c *PostController) Routes(router *router.RouterGroup) {
  // ✨ Clean, readable authorization
  router.POST("/posts", c.Create, authorization.Can("create", "Post"))
  router.GET("/posts", c.List, authorization.Can("list", "Post"))
  router.PUT("/posts/:id", c.Update, authorization.CanAccess("update", "Post", "id"))
  router.DELETE("/posts/:id", c.Delete, authorization.CanAccess("delete", "Post", "id"))
  
  // Role-based protection
  adminGroup := router.Group("/admin", authorization.HasRole("Administrator"))
  ownerGroup := router.Group("/owner", authorization.HasRole("Owner"))
}`,o))}," Copy ")]),t[127]||(t[127]=e("pre",{class:"text-sm text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-blue-400"},"import"),s(),e("span",{class:"text-green-400"},'"authorization"'),s(`

`),e("span",{class:"text-blue-400"},"func"),s(" (c *PostController) "),e("span",{class:"text-yellow-400"},"Routes"),s(`(router *router.RouterGroup) {
  `),e("span",{class:"text-green-400"},"// ✨ Clean, readable authorization"),s(`
  router.POST(`),e("span",{class:"text-red-400"},'"/posts"'),s(", c.Create, "),e("span",{class:"text-purple-400"},'authorization.Can("create", "Post")'),s(`)
  router.GET(`),e("span",{class:"text-red-400"},'"/posts"'),s(", c.List, "),e("span",{class:"text-purple-400"},'authorization.Can("list", "Post")'),s(`)
  router.PUT(`),e("span",{class:"text-red-400"},'"/posts/:id"'),s(", c.Update, "),e("span",{class:"text-purple-400"},'authorization.CanAccess("update", "Post", "id")'),s(`)
  router.DELETE(`),e("span",{class:"text-red-400"},'"/posts/:id"'),s(", c.Delete, "),e("span",{class:"text-purple-400"},'authorization.CanAccess("delete", "Post", "id")'),s(`)
  
  `),e("span",{class:"text-green-400"},"// Role-based protection"),s(`
  adminGroup := router.Group(`),e("span",{class:"text-red-400"},'"/admin"'),s(", "),e("span",{class:"text-purple-400"},'authorization.HasRole("Administrator")'),s(`)
  ownerGroup := router.Group(`),e("span",{class:"text-red-400"},'"/owner"'),s(", "),e("span",{class:"text-purple-400"},'authorization.HasRole("Owner")'),s(`)
}`)])],-1))])]),e("div",Pt,[e("div",Ct,[t[134]||(t[134]=e("h5",{class:"font-medium text-gray-900 dark:text-white mb-2"},"1. Can() - General Resource Protection",-1)),t[135]||(t[135]=e("p",{class:"text-sm text-gray-600 dark:text-gray-300 mb-3"}," The intuitive way to check if a user has permission to perform an action on a resource type. ",-1)),e("div",At,[e("div",null,[t[130]||(t[130]=e("h6",{class:"text-sm font-medium text-gray-900 dark:text-white mb-2"},"✨ New Syntax (Recommended)",-1)),e("div",Tt,[e("div",Et,[t[128]||(t[128]=e("span",{class:"text-xs text-gray-400"},"Can() Function",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[7]||(t[7]=o=>l(`// ✨ Clean, readable syntax
router.POST("/posts", c.Create, authorization.Can("create", "Post"))
router.GET("/posts", c.List, authorization.Can("list", "Post"))
router.PUT("/posts", c.Update, authorization.Can("update", "Post"))

// Multiple permissions
router.POST("/posts", c.Create, 
  authorization.Can("create", "Post"),
  authorization.HasRole("Member"))`,o))}," Copy ")]),t[129]||(t[129]=e("pre",{class:"text-xs text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-green-400"},"// ✨ Clean, readable syntax"),s(`
router.POST(`),e("span",{class:"text-red-400"},'"/posts"'),s(", c.Create, "),e("span",{class:"text-purple-400"},'authorization.Can("create", "Post")'),s(`)
router.GET(`),e("span",{class:"text-red-400"},'"/posts"'),s(", c.List, "),e("span",{class:"text-purple-400"},'authorization.Can("list", "Post")'),s(`)
router.PUT(`),e("span",{class:"text-red-400"},'"/posts"'),s(", c.Update, "),e("span",{class:"text-purple-400"},'authorization.Can("update", "Post")'),s(`)

`),e("span",{class:"text-green-400"},"// Multiple permissions"),s(`
router.POST(`),e("span",{class:"text-red-400"},'"/posts"'),s(`, c.Create, 
  `),e("span",{class:"text-purple-400"},'authorization.Can("create", "Post")'),s(`,
  `),e("span",{class:"text-purple-400"},'authorization.HasRole("Member")'),s(")")])],-1))])]),e("div",null,[t[133]||(t[133]=e("h6",{class:"text-sm font-medium text-gray-900 dark:text-white mb-2"},"🔧 Legacy Syntax",-1)),e("div",zt,[e("div",Rt,[t[131]||(t[131]=e("span",{class:"text-xs text-gray-400"},"AuthMiddleware",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[8]||(t[8]=o=>l(`// Legacy syntax (still supported)
router.POST("/posts", c.Create, 
  authorization.AuthMiddleware("post", "create"))
router.GET("/posts", c.List,
  authorization.AuthMiddleware("post", "list"))`,o))}," Copy ")]),t[132]||(t[132]=e("pre",{class:"text-xs text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-green-400"},"// Legacy syntax (still supported)"),s(`
router.POST(`),e("span",{class:"text-red-400"},'"/posts"'),s(`, c.Create, 
  `),e("span",{class:"text-gray-400"},'authorization.AuthMiddleware("post", "create")'),s(`)
router.GET(`),e("span",{class:"text-red-400"},'"/posts"'),s(`, c.List,
  `),e("span",{class:"text-gray-400"},'authorization.AuthMiddleware("post", "list")'),s(")")])],-1))])])])]),e("div",_t,[t[142]||(t[142]=e("h5",{class:"font-medium text-gray-900 dark:text-white mb-2"},"2. CanAccess() - Specific Resource Protection",-1)),t[143]||(t[143]=e("p",{class:"text-sm text-gray-600 dark:text-gray-300 mb-3"}," Checks if a user has permission to perform an action on a specific resource instance. ",-1)),e("div",Gt,[e("div",null,[t[138]||(t[138]=e("h6",{class:"text-sm font-medium text-gray-900 dark:text-white mb-2"},"✨ New Syntax (Recommended)",-1)),e("div",St,[e("div",It,[t[136]||(t[136]=e("span",{class:"text-xs text-gray-400"},"CanAccess() Function",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[9]||(t[9]=o=>l(`// ✨ Check access to specific resources
router.PUT("/posts/:id", c.Update, 
  authorization.CanAccess("update", "Post", "id"))
  
router.DELETE("/posts/:id", c.Delete, 
  authorization.CanAccess("delete", "Post", "id"))

// Different parameter names
router.PUT("/users/:userId/posts/:postId", c.UpdateUserPost, 
  authorization.CanAccess("update", "Post", "postId"))`,o))}," Copy ")]),t[137]||(t[137]=e("pre",{class:"text-xs text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-green-400"},"// ✨ Check access to specific resources"),s(`
router.PUT(`),e("span",{class:"text-red-400"},'"/posts/:id"'),s(`, c.Update, 
  `),e("span",{class:"text-purple-400"},'authorization.CanAccess("update", "Post", "id")'),s(`)
  
router.DELETE(`),e("span",{class:"text-red-400"},'"/posts/:id"'),s(`, c.Delete, 
  `),e("span",{class:"text-purple-400"},'authorization.CanAccess("delete", "Post", "id")'),s(`)

`),e("span",{class:"text-green-400"},"// Different parameter names"),s(`
router.PUT(`),e("span",{class:"text-red-400"},'"/users/:userId/posts/:postId"'),s(`, c.UpdateUserPost, 
  `),e("span",{class:"text-purple-400"},'authorization.CanAccess("update", "Post", "postId")'),s(")")])],-1))])]),e("div",null,[t[141]||(t[141]=e("h6",{class:"text-sm font-medium text-gray-900 dark:text-white mb-2"},"🔧 Legacy Syntax",-1)),e("div",Ot,[e("div",Ut,[t[139]||(t[139]=e("span",{class:"text-xs text-gray-400"},"ResourceAuthMiddleware",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[10]||(t[10]=o=>l(`// Legacy syntax (still supported)
router.PUT("/posts/:id", c.Update, 
  authorization.ResourceAuthMiddleware("post", "update", "id"))
  
router.DELETE("/posts/:id", c.Delete,
  authorization.ResourceAuthMiddleware("post", "delete", "id"))`,o))}," Copy ")]),t[140]||(t[140]=e("pre",{class:"text-xs text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-green-400"},"// Legacy syntax (still supported)"),s(`
router.PUT(`),e("span",{class:"text-red-400"},'"/posts/:id"'),s(`, c.Update, 
  `),e("span",{class:"text-gray-400"},'authorization.ResourceAuthMiddleware("post", "update", "id")'),s(`)
  
router.DELETE(`),e("span",{class:"text-red-400"},'"/posts/:id"'),s(`, c.Delete,
  `),e("span",{class:"text-gray-400"},'authorization.ResourceAuthMiddleware("post", "delete", "id")'),s(")")])],-1))])])])]),e("div",Dt,[t[150]||(t[150]=e("h5",{class:"font-medium text-gray-900 dark:text-white mb-2"},"3. HasRole() - Role-Based Protection",-1)),t[151]||(t[151]=e("p",{class:"text-sm text-gray-600 dark:text-gray-300 mb-3"}," Ensures the user has a specific role (Owner, Administrator, Member, External). ",-1)),e("div",Lt,[e("div",null,[t[146]||(t[146]=e("h6",{class:"text-sm font-medium text-gray-900 dark:text-white mb-2"},"✨ New Syntax (Recommended)",-1)),e("div",jt,[e("div",Mt,[t[144]||(t[144]=e("span",{class:"text-xs text-gray-400"},"HasRole() Function",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[11]||(t[11]=o=>l(`// ✨ Clean role checking
adminGroup := router.Group("/admin", 
  authorization.HasRole("Administrator"))

ownerGroup := router.Group("/owner", 
  authorization.HasRole("Owner"))

// Individual routes  
router.GET("/admin/settings", c.GetSettings, 
  authorization.HasRole("Administrator"))

// Multiple role checks
router.POST("/posts", c.Create,
  authorization.HasRole("Member"),
  authorization.Can("create", "Post"))`,o))}," Copy ")]),t[145]||(t[145]=e("pre",{class:"text-xs text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-green-400"},"// ✨ Clean role checking"),s(`
adminGroup := router.Group(`),e("span",{class:"text-red-400"},'"/admin"'),s(`, 
  `),e("span",{class:"text-purple-400"},'authorization.HasRole("Administrator")'),s(`)

ownerGroup := router.Group(`),e("span",{class:"text-red-400"},'"/owner"'),s(`, 
  `),e("span",{class:"text-purple-400"},'authorization.HasRole("Owner")'),s(`)

`),e("span",{class:"text-green-400"},"// Individual routes"),s(`  
router.GET(`),e("span",{class:"text-red-400"},'"/admin/settings"'),s(`, c.GetSettings, 
  `),e("span",{class:"text-purple-400"},'authorization.HasRole("Administrator")'),s(`)

`),e("span",{class:"text-green-400"},"// Multiple role checks"),s(`
router.POST(`),e("span",{class:"text-red-400"},'"/posts"'),s(`, c.Create,
  `),e("span",{class:"text-purple-400"},'authorization.HasRole("Member")'),s(`,
  `),e("span",{class:"text-purple-400"},'authorization.Can("create", "Post")'),s(")")])],-1))])]),e("div",null,[t[149]||(t[149]=e("h6",{class:"text-sm font-medium text-gray-900 dark:text-white mb-2"},"🔧 Legacy Syntax",-1)),e("div",Bt,[e("div",Ht,[t[147]||(t[147]=e("span",{class:"text-xs text-gray-400"},"RequireRole",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[12]||(t[12]=o=>l(`// Legacy syntax (still supported)
adminGroup := router.Group("/admin",
  authorization.RequireRole("Administrator"))
  
ownerGroup := router.Group("/owner",
  authorization.RequireRole("Owner"))`,o))}," Copy ")]),t[148]||(t[148]=e("pre",{class:"text-xs text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-green-400"},"// Legacy syntax (still supported)"),s(`
adminGroup := router.Group(`),e("span",{class:"text-red-400"},'"/admin"'),s(`,
  `),e("span",{class:"text-gray-400"},'authorization.RequireRole("Administrator")'),s(`)
  
ownerGroup := router.Group(`),e("span",{class:"text-red-400"},'"/owner"'),s(`,
  `),e("span",{class:"text-gray-400"},'authorization.RequireRole("Owner")'),s(")")])],-1))])])])]),e("div",Nt,[t[158]||(t[158]=e("h5",{class:"font-medium text-gray-900 dark:text-white mb-2"},"4. Advanced Permission Checks",-1)),t[159]||(t[159]=e("p",{class:"text-sm text-gray-600 dark:text-gray-300 mb-3"}," Additional flexible authorization functions for complex scenarios. ",-1)),e("div",Jt,[e("div",null,[t[154]||(t[154]=e("h6",{class:"text-sm font-medium text-gray-900 dark:text-white mb-2"},"🔄 CanAny() - Any Permission",-1)),e("div",Ft,[e("div",qt,[t[152]||(t[152]=e("span",{class:"text-xs text-gray-400"},"OR Logic",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[13]||(t[13]=o=>l(`// User needs ANY of these permissions
router.GET("/posts/moderate", c.ModeratePosts,
  authorization.CanAny([]string{
    "moderate:Post",
    "delete:Post",
    "update:Post",
  }))

// Editor or admin access
router.POST("/content", c.CreateContent,
  authorization.CanAny([]string{
    "create:Content",
    "edit:Content",
  }))`,o))}," Copy ")]),t[153]||(t[153]=e("pre",{class:"text-xs text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-green-400"},"// User needs ANY of these permissions"),s(`
router.GET(`),e("span",{class:"text-red-400"},'"/posts/moderate"'),s(`, c.ModeratePosts,
  `),e("span",{class:"text-purple-400"},`authorization.CanAny([]string{
    "moderate:Post",
    "delete:Post",
    "update:Post",
  })`),s(`)

`),e("span",{class:"text-green-400"},"// Editor or admin access"),s(`
router.POST(`),e("span",{class:"text-red-400"},'"/content"'),s(`, c.CreateContent,
  `),e("span",{class:"text-purple-400"},`authorization.CanAny([]string{
    "create:Content",
    "edit:Content",
  })`),s(")")])],-1))])]),e("div",null,[t[157]||(t[157]=e("h6",{class:"text-sm font-medium text-gray-900 dark:text-white mb-2"},"🔒 CanAll() - All Permissions",-1)),e("div",Wt,[e("div",Xt,[t[155]||(t[155]=e("span",{class:"text-xs text-gray-400"},"AND Logic",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[14]||(t[14]=o=>l(`// User needs ALL of these permissions  
router.POST("/posts/publish", c.PublishPost,
  authorization.CanAll([]string{
    "create:Post",
    "publish:Post",
    "read:Post",
  }))

// Requires multiple related permissions
router.DELETE("/users/:id", c.DeleteUser,
  authorization.CanAll([]string{
    "delete:User",
    "manage:User",
  }))`,o))}," Copy ")]),t[156]||(t[156]=e("pre",{class:"text-xs text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-green-400"},"// User needs ALL of these permissions"),s(`  
router.POST(`),e("span",{class:"text-red-400"},'"/posts/publish"'),s(`, c.PublishPost,
  `),e("span",{class:"text-purple-400"},`authorization.CanAll([]string{
    "create:Post",
    "publish:Post",
    "read:Post",
  })`),s(`)

`),e("span",{class:"text-green-400"},"// Requires multiple related permissions"),s(`
router.DELETE(`),e("span",{class:"text-red-400"},'"/users/:id"'),s(`, c.DeleteUser,
  `),e("span",{class:"text-purple-400"},`authorization.CanAll([]string{
    "delete:User",
    "manage:User",
  })`),s(")")])],-1))])])])])])])]),_:1}),n(i,null,{header:a(()=>[e("div",Kt,[n(r,{name:"i-lucide-settings-2",class:"h-4 w-4 text-orange-500"}),t[161]||(t[161]=e("span",{class:"font-semibold"},"Authorization API Endpoints",-1))])]),default:a(()=>[e("div",Vt,[t[182]||(t[182]=e("p",{class:"text-sm text-gray-600 dark:text-gray-300"}," The authorization module exposes REST API endpoints for managing roles, permissions, and checking access: ",-1)),e("div",$t,[e("div",Yt,[t[172]||(t[172]=e("h5",{class:"font-medium text-gray-900 dark:text-white"},"Role Management",-1)),e("div",Zt,[e("div",Qt,[t[163]||(t[163]=e("span",{class:"text-green-800 dark:text-green-200"},"GET /authorization/roles",-1)),n(u,{color:"green",variant:"soft",size:"xs"},{default:a(()=>t[162]||(t[162]=[s("List",-1)])),_:1,__:[162]})]),e("div",es,[t[165]||(t[165]=e("span",{class:"text-blue-800 dark:text-blue-200"},"GET /authorization/roles/:id",-1)),n(u,{color:"blue",variant:"soft",size:"xs"},{default:a(()=>t[164]||(t[164]=[s("Get",-1)])),_:1,__:[164]})]),e("div",ts,[t[167]||(t[167]=e("span",{class:"text-purple-800 dark:text-purple-200"},"POST /authorization/roles",-1)),n(u,{color:"purple",variant:"soft",size:"xs"},{default:a(()=>t[166]||(t[166]=[s("Create",-1)])),_:1,__:[166]})]),e("div",ss,[t[169]||(t[169]=e("span",{class:"text-orange-800 dark:text-orange-200"},"PUT /authorization/roles/:id",-1)),n(u,{color:"orange",variant:"soft",size:"xs"},{default:a(()=>t[168]||(t[168]=[s("Update",-1)])),_:1,__:[168]})]),e("div",ns,[t[171]||(t[171]=e("span",{class:"text-red-800 dark:text-red-200"},"DELETE /authorization/roles/:id",-1)),n(u,{color:"red",variant:"soft",size:"xs"},{default:a(()=>t[170]||(t[170]=[s("Delete",-1)])),_:1,__:[170]})])])]),e("div",as,[t[181]||(t[181]=e("h5",{class:"font-medium text-gray-900 dark:text-white"},"Permission Management",-1)),e("div",rs,[e("div",os,[t[174]||(t[174]=e("span",{class:"text-green-800 dark:text-green-200"},"GET /authorization/roles/:id/permissions",-1)),n(u,{color:"green",variant:"soft",size:"xs"},{default:a(()=>t[173]||(t[173]=[s("List",-1)])),_:1,__:[173]})]),e("div",ls,[t[176]||(t[176]=e("span",{class:"text-purple-800 dark:text-purple-200"},"POST /authorization/roles/:id/permissions",-1)),n(u,{color:"purple",variant:"soft",size:"xs"},{default:a(()=>t[175]||(t[175]=[s("Assign",-1)])),_:1,__:[175]})]),e("div",is,[t[178]||(t[178]=e("span",{class:"text-red-800 dark:text-red-200"},"DELETE /authorization/roles/:id/permissions/:permId",-1)),n(u,{color:"red",variant:"soft",size:"xs"},{default:a(()=>t[177]||(t[177]=[s("Revoke",-1)])),_:1,__:[177]})]),e("div",ds,[t[180]||(t[180]=e("span",{class:"text-blue-800 dark:text-blue-200"},"POST /authorization/check",-1)),n(u,{color:"blue",variant:"soft",size:"xs"},{default:a(()=>t[179]||(t[179]=[s("Check",-1)])),_:1,__:[179]})])])])])])]),_:1}),n(i,null,{header:a(()=>[e("div",us,[n(r,{name:"i-lucide-globe",class:"h-4 w-4 text-blue-500"}),t[183]||(t[183]=e("span",{class:"font-semibold"},"Frontend Permission Checking",-1))])]),default:a(()=>[e("div",ps,[t[193]||(t[193]=e("p",{class:"text-sm text-gray-600 dark:text-gray-300"}," Check user permissions from your frontend using the authorization API endpoints: ",-1)),e("div",cs,[e("div",null,[t[186]||(t[186]=e("h5",{class:"font-medium text-gray-900 dark:text-white mb-2"},"Vue.js Composable Example",-1)),e("div",xs,[e("div",gs,[t[184]||(t[184]=e("span",{class:"text-xs text-gray-400"},"useAuth.js Composable",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[15]||(t[15]=o=>l(`// composables/useAuth.js
import { ref, computed } from 'vue'

const user = ref(null)
const token = ref(localStorage.getItem('auth_token'))

export function useAuth() {
  const isAuthenticated = computed(() => !!token.value && !!user.value)

  // Check if user has permission for a resource type and action
  const checkPermission = async (resourceType, action, resourceId = null) => {
    if (!isAuthenticated.value) return false

    try {
      const response = await fetch('/api/authorization/check', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': \`Bearer \${token.value}\`,
          'Base-Orgid': getCurrentOrgId() // Your org ID
        },
        body: JSON.stringify({
          user_id: user.value.id,
          organization_id: getCurrentOrgId(),
          resource_type: resourceType,
          action: action,
          resource_id: resourceId
        })
      })

      const data = await response.json()
      return data.has_permission || false
    } catch (error) {
      console.error('Permission check failed:', error)
      return false
    }
  }

  // Check if user has a specific role
  const hasRole = (roleName) => {
    return user.value?.roles?.some(role => role.name === roleName) || false
  }

  return {
    user,
    token,
    isAuthenticated,
    checkPermission,
    hasRole
  }
}`,o))}," Copy ")]),t[185]||(t[185]=e("pre",{class:"text-sm text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-green-400"},"// composables/useAuth.js"),s(`
`),e("span",{class:"text-blue-400"},"import"),s(" { ref, computed } "),e("span",{class:"text-blue-400"},"from"),s(),e("span",{class:"text-green-400"},"'vue'"),s(`

`),e("span",{class:"text-blue-400"},"const"),s(" user = "),e("span",{class:"text-yellow-400"},"ref"),s("("),e("span",{class:"text-purple-400"},"null"),s(`)
`),e("span",{class:"text-blue-400"},"const"),s(" token = "),e("span",{class:"text-yellow-400"},"ref"),s("("),e("span",{class:"text-yellow-400"},"localStorage.getItem"),s("("),e("span",{class:"text-green-400"},"'auth_token'"),s(`))

`),e("span",{class:"text-blue-400"},"export function"),s(),e("span",{class:"text-yellow-400"},"useAuth"),s(`() {
  `),e("span",{class:"text-blue-400"},"const"),s(" isAuthenticated = "),e("span",{class:"text-yellow-400"},"computed"),s(`(() => !!token.value && !!user.value)

  `),e("span",{class:"text-green-400"},"// Check if user has permission for a resource type and action"),s(`
  `),e("span",{class:"text-blue-400"},"const"),s(),e("span",{class:"text-yellow-400"},"checkPermission"),s(" = "),e("span",{class:"text-blue-400"},"async"),s(" (resourceType, action, resourceId = "),e("span",{class:"text-purple-400"},"null"),s(`) => {
    `),e("span",{class:"text-blue-400"},"if"),s(" (!isAuthenticated.value) "),e("span",{class:"text-blue-400"},"return"),s(),e("span",{class:"text-purple-400"},"false"),s(`

    `),e("span",{class:"text-blue-400"},"try"),s(` {
      `),e("span",{class:"text-blue-400"},"const"),s(" response = "),e("span",{class:"text-blue-400"},"await"),s(),e("span",{class:"text-yellow-400"},"fetch"),s("("),e("span",{class:"text-green-400"},"'/api/authorization/check'"),s(`, {
        method: `),e("span",{class:"text-green-400"},"'POST'"),s(`,
        headers: {
          `),e("span",{class:"text-green-400"},"'Content-Type'"),s(": "),e("span",{class:"text-green-400"},"'application/json'"),s(`,
          `),e("span",{class:"text-green-400"},"'Authorization'"),s(": "),e("span",{class:"text-green-400"},"`Bearer ${token.value}`"),s(`,
          `),e("span",{class:"text-green-400"},"'Base-Orgid'"),s(": "),e("span",{class:"text-yellow-400"},"getCurrentOrgId"),s("() "),e("span",{class:"text-green-400"},"// Your org ID"),s(`
        },
        body: `),e("span",{class:"text-blue-400"},"JSON.stringify"),s(`({
          user_id: user.value.id,
          organization_id: `),e("span",{class:"text-yellow-400"},"getCurrentOrgId"),s(`(),
          resource_type: resourceType,
          action: action,
          resource_id: resourceId
        })
      })

      `),e("span",{class:"text-blue-400"},"const"),s(" data = "),e("span",{class:"text-blue-400"},"await"),s(` response.json()
      `),e("span",{class:"text-blue-400"},"return"),s(" data.has_permission || "),e("span",{class:"text-purple-400"},"false"),s(`
    } `),e("span",{class:"text-blue-400"},"catch"),s(` (error) {
      console.error(`),e("span",{class:"text-green-400"},"'Permission check failed:'"),s(`, error)
      `),e("span",{class:"text-blue-400"},"return"),s(),e("span",{class:"text-purple-400"},"false"),s(`
    }
  }

  `),e("span",{class:"text-green-400"},"// Check if user has a specific role"),s(`
  `),e("span",{class:"text-blue-400"},"const"),s(),e("span",{class:"text-yellow-400"},"hasRole"),s(` = (roleName) => {
    `),e("span",{class:"text-blue-400"},"return"),s(" user.value?.roles?.some(role => role.name === roleName) || "),e("span",{class:"text-purple-400"},"false"),s(`
  }

  `),e("span",{class:"text-blue-400"},"return"),s(` {
    user,
    token,
    isAuthenticated,
    checkPermission,
    hasRole
  }
}`)])],-1))])]),e("div",null,[t[189]||(t[189]=e("h5",{class:"font-medium text-gray-900 dark:text-white mb-2"},"Vue Component Usage",-1)),e("div",ms,[e("div",bs,[t[187]||(t[187]=e("span",{class:"text-xs text-gray-400"},"Component Example",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[16]||(t[16]=o=>l(`<template>
  <div class="post-actions">
    <!-- Show edit button only if user can update posts -->
    <button 
      v-if="canEditPost" 
      @click="editPost"
      class="btn btn-primary">
      Edit Post
    </button>
    
    <!-- Show delete button only if user can delete this specific post -->
    <button 
      v-if="canDeletePost" 
      @click="deletePost"
      class="btn btn-danger">
      Delete Post
    </button>
    
    <!-- Show admin panel only for administrators -->
    <router-link 
      v-if="isAdmin" 
      to="/admin"
      class="btn btn-secondary">
      Admin Panel
    </router-link>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import { useAuth } from '@/composables/useAuth'

const props = defineProps(['post'])
const { checkPermission, hasRole } = useAuth()

const canEditPost = ref(false)
const canDeletePost = ref(false) 
const isAdmin = ref(false)

onMounted(async () => {
  // Check general permission to update posts
  canEditPost.value = await checkPermission('post', 'update')
  
  // Check permission to delete this specific post
  canDeletePost.value = await checkPermission('post', 'delete', props.post.id)
  
  // Check if user has Administrator role
  isAdmin.value = hasRole('Administrator')
})
<\/script>`,o))}," Copy ")]),t[188]||(t[188]=e("pre",{class:"text-sm text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-blue-400"},"<template>"),s(`
  `),e("span",{class:"text-blue-400"},"<div"),s(),e("span",{class:"text-green-400"},"class="),e("span",{class:"text-red-400"},'"post-actions"'),e("span",{class:"text-blue-400"},">"),s(`
    `),e("span",{class:"text-green-400"},"<!-- Show edit button only if user can update posts -->"),s(`
    `),e("span",{class:"text-blue-400"},"<button"),s(` 
      `),e("span",{class:"text-green-400"},"v-if="),e("span",{class:"text-red-400"},'"canEditPost"'),s(` 
      `),e("span",{class:"text-green-400"},"@click="),e("span",{class:"text-red-400"},'"editPost"'),s(`
      `),e("span",{class:"text-green-400"},"class="),e("span",{class:"text-red-400"},'"btn btn-primary"'),e("span",{class:"text-blue-400"},">"),s(`
      Edit Post
    `),e("span",{class:"text-blue-400"},"</button>"),s(`
    
    `),e("span",{class:"text-green-400"},"<!-- Show delete button only if user can delete this specific post -->"),s(`
    `),e("span",{class:"text-blue-400"},"<button"),s(` 
      `),e("span",{class:"text-green-400"},"v-if="),e("span",{class:"text-red-400"},'"canDeletePost"'),s(` 
      `),e("span",{class:"text-green-400"},"@click="),e("span",{class:"text-red-400"},'"deletePost"'),s(`
      `),e("span",{class:"text-green-400"},"class="),e("span",{class:"text-red-400"},'"btn btn-danger"'),e("span",{class:"text-blue-400"},">"),s(`
      Delete Post
    `),e("span",{class:"text-blue-400"},"</button>"),s(`
    
    `),e("span",{class:"text-green-400"},"<!-- Show admin panel only for administrators -->"),s(`
    `),e("span",{class:"text-blue-400"},"<router-link"),s(` 
      `),e("span",{class:"text-green-400"},"v-if="),e("span",{class:"text-red-400"},'"isAdmin"'),s(` 
      `),e("span",{class:"text-green-400"},"to="),e("span",{class:"text-red-400"},'"/admin"'),s(`
      `),e("span",{class:"text-green-400"},"class="),e("span",{class:"text-red-400"},'"btn btn-secondary"'),e("span",{class:"text-blue-400"},">"),s(`
      Admin Panel
    `),e("span",{class:"text-blue-400"},"</router-link>"),s(`
  `),e("span",{class:"text-blue-400"},"</div>"),s(`
`),e("span",{class:"text-blue-400"},"</template>"),s(`

`),e("span",{class:"text-blue-400"},"<script setup>"),s(`
`),e("span",{class:"text-blue-400"},"import"),s(" { ref, onMounted } "),e("span",{class:"text-blue-400"},"from"),s(),e("span",{class:"text-green-400"},"'vue'"),s(`
`),e("span",{class:"text-blue-400"},"import"),s(" { useAuth } "),e("span",{class:"text-blue-400"},"from"),s(),e("span",{class:"text-green-400"},"'@/composables/useAuth'"),s(`

`),e("span",{class:"text-blue-400"},"const"),s(" props = "),e("span",{class:"text-yellow-400"},"defineProps"),s("(["),e("span",{class:"text-green-400"},"'post'"),s(`])
`),e("span",{class:"text-blue-400"},"const"),s(" { checkPermission, hasRole } = "),e("span",{class:"text-yellow-400"},"useAuth"),s(`()

`),e("span",{class:"text-blue-400"},"const"),s(" canEditPost = "),e("span",{class:"text-yellow-400"},"ref"),s("("),e("span",{class:"text-purple-400"},"false"),s(`)
`),e("span",{class:"text-blue-400"},"const"),s(" canDeletePost = "),e("span",{class:"text-yellow-400"},"ref"),s("("),e("span",{class:"text-purple-400"},"false"),s(`) 
`),e("span",{class:"text-blue-400"},"const"),s(" isAdmin = "),e("span",{class:"text-yellow-400"},"ref"),s("("),e("span",{class:"text-purple-400"},"false"),s(`)

`),e("span",{class:"text-yellow-400"},"onMounted"),s("("),e("span",{class:"text-blue-400"},"async"),s(` () => {
  `),e("span",{class:"text-green-400"},"// Check general permission to update posts"),s(`
  canEditPost.value = `),e("span",{class:"text-blue-400"},"await"),s(),e("span",{class:"text-yellow-400"},"checkPermission"),s("("),e("span",{class:"text-green-400"},"'post'"),s(", "),e("span",{class:"text-green-400"},"'update'"),s(`)
  
  `),e("span",{class:"text-green-400"},"// Check permission to delete this specific post"),s(`
  canDeletePost.value = `),e("span",{class:"text-blue-400"},"await"),s(),e("span",{class:"text-yellow-400"},"checkPermission"),s("("),e("span",{class:"text-green-400"},"'post'"),s(", "),e("span",{class:"text-green-400"},"'delete'"),s(`, props.post.id)
  
  `),e("span",{class:"text-green-400"},"// Check if user has Administrator role"),s(`
  isAdmin.value = `),e("span",{class:"text-yellow-400"},"hasRole"),s("("),e("span",{class:"text-green-400"},"'Administrator'"),s(`)
})
`),e("span",{class:"text-blue-400"},"<\/script>")])],-1))])]),e("div",null,[t[192]||(t[192]=e("h5",{class:"font-medium text-gray-900 dark:text-white mb-2"},"JavaScript/React Example",-1)),e("div",ys,[e("div",fs,[t[190]||(t[190]=e("span",{class:"text-xs text-gray-400"},"React Hook",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[17]||(t[17]=o=>l(`// hooks/usePermissions.js
import { useState, useEffect } from 'react'
import { useAuth } from './useAuth'

export function usePermissions() {
  const { user, token, isAuthenticated } = useAuth()

  const checkPermission = async (resourceType, action, resourceId = null) => {
    if (!isAuthenticated) return false

    try {
      const response = await fetch('/api/authorization/check', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': \`Bearer \${token}\`,
          'Base-Orgid': getCurrentOrgId()
        },
        body: JSON.stringify({
          user_id: user.id,
          organization_id: getCurrentOrgId(),
          resource_type: resourceType,
          action: action,
          resource_id: resourceId
        })
      })

      const data = await response.json()
      return data.has_permission || false
    } catch (error) {
      console.error('Permission check failed:', error)
      return false
    }
  }

  return { checkPermission }
}

// Component usage
function PostComponent({ post }) {
  const [canEdit, setCanEdit] = useState(false)
  const [canDelete, setCanDelete] = useState(false)
  const { checkPermission } = usePermissions()

  useEffect(() => {
    const checkPermissions = async () => {
      setCanEdit(await checkPermission('post', 'update'))
      setCanDelete(await checkPermission('post', 'delete', post.id))
    }
    
    checkPermissions()
  }, [post.id])

  return (
    <div className="post-actions">
      {canEdit && <button onClick={editPost}>Edit</button>}
      {canDelete && <button onClick={deletePost}>Delete</button>}
    </div>
  )
}`,o))}," Copy ")]),t[191]||(t[191]=e("pre",{class:"text-sm text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-green-400"},"// hooks/usePermissions.js"),s(`
`),e("span",{class:"text-blue-400"},"import"),s(" { useState, useEffect } "),e("span",{class:"text-blue-400"},"from"),s(),e("span",{class:"text-green-400"},"'react'"),s(`
`),e("span",{class:"text-blue-400"},"import"),s(" { useAuth } "),e("span",{class:"text-blue-400"},"from"),s(),e("span",{class:"text-green-400"},"'./useAuth'"),s(`

`),e("span",{class:"text-blue-400"},"export function"),s(),e("span",{class:"text-yellow-400"},"usePermissions"),s(`() {
  `),e("span",{class:"text-blue-400"},"const"),s(" { user, token, isAuthenticated } = "),e("span",{class:"text-yellow-400"},"useAuth"),s(`()

  `),e("span",{class:"text-blue-400"},"const"),s(),e("span",{class:"text-yellow-400"},"checkPermission"),s(" = "),e("span",{class:"text-blue-400"},"async"),s(" (resourceType, action, resourceId = "),e("span",{class:"text-purple-400"},"null"),s(`) => {
    `),e("span",{class:"text-blue-400"},"if"),s(" (!isAuthenticated) "),e("span",{class:"text-blue-400"},"return"),s(),e("span",{class:"text-purple-400"},"false"),s(`

    `),e("span",{class:"text-blue-400"},"try"),s(` {
      `),e("span",{class:"text-blue-400"},"const"),s(" response = "),e("span",{class:"text-blue-400"},"await"),s(),e("span",{class:"text-yellow-400"},"fetch"),s("("),e("span",{class:"text-green-400"},"'/api/authorization/check'"),s(`, {
        method: `),e("span",{class:"text-green-400"},"'POST'"),s(`,
        headers: {
          `),e("span",{class:"text-green-400"},"'Content-Type'"),s(": "),e("span",{class:"text-green-400"},"'application/json'"),s(`,
          `),e("span",{class:"text-green-400"},"'Authorization'"),s(": "),e("span",{class:"text-green-400"},"`Bearer ${token}`"),s(`,
          `),e("span",{class:"text-green-400"},"'Base-Orgid'"),s(": "),e("span",{class:"text-yellow-400"},"getCurrentOrgId"),s(`()
        },
        body: `),e("span",{class:"text-blue-400"},"JSON.stringify"),s(`({
          user_id: user.id,
          organization_id: `),e("span",{class:"text-yellow-400"},"getCurrentOrgId"),s(`(),
          resource_type: resourceType,
          action: action,
          resource_id: resourceId
        })
      })

      `),e("span",{class:"text-blue-400"},"const"),s(" data = "),e("span",{class:"text-blue-400"},"await"),s(` response.json()
      `),e("span",{class:"text-blue-400"},"return"),s(" data.has_permission || "),e("span",{class:"text-purple-400"},"false"),s(`
    } `),e("span",{class:"text-blue-400"},"catch"),s(` (error) {
      console.error(`),e("span",{class:"text-green-400"},"'Permission check failed:'"),s(`, error)
      `),e("span",{class:"text-blue-400"},"return"),s(),e("span",{class:"text-purple-400"},"false"),s(`
    }
  }

  `),e("span",{class:"text-blue-400"},"return"),s(` { checkPermission }
}

`),e("span",{class:"text-green-400"},"// Component usage"),s(`
`),e("span",{class:"text-blue-400"},"function"),s(),e("span",{class:"text-yellow-400"},"PostComponent"),s(`({ post }) {
  `),e("span",{class:"text-blue-400"},"const"),s(" [canEdit, setCanEdit] = "),e("span",{class:"text-yellow-400"},"useState"),s("("),e("span",{class:"text-purple-400"},"false"),s(`)
  `),e("span",{class:"text-blue-400"},"const"),s(" [canDelete, setCanDelete] = "),e("span",{class:"text-yellow-400"},"useState"),s("("),e("span",{class:"text-purple-400"},"false"),s(`)
  `),e("span",{class:"text-blue-400"},"const"),s(" { checkPermission } = "),e("span",{class:"text-yellow-400"},"usePermissions"),s(`()

  `),e("span",{class:"text-yellow-400"},"useEffect"),s(`(() => {
    `),e("span",{class:"text-blue-400"},"const"),s(),e("span",{class:"text-yellow-400"},"checkPermissions"),s(" = "),e("span",{class:"text-blue-400"},"async"),s(` () => {
      `),e("span",{class:"text-yellow-400"},"setCanEdit"),s("("),e("span",{class:"text-blue-400"},"await"),s(),e("span",{class:"text-yellow-400"},"checkPermission"),s("("),e("span",{class:"text-green-400"},"'post'"),s(", "),e("span",{class:"text-green-400"},"'update'"),s(`))
      `),e("span",{class:"text-yellow-400"},"setCanDelete"),s("("),e("span",{class:"text-blue-400"},"await"),s(),e("span",{class:"text-yellow-400"},"checkPermission"),s("("),e("span",{class:"text-green-400"},"'post'"),s(", "),e("span",{class:"text-green-400"},"'delete'"),s(`, post.id))
    }
    
    `),e("span",{class:"text-yellow-400"},"checkPermissions"),s(`()
  }, [post.id])

  `),e("span",{class:"text-blue-400"},"return"),s(` (
    `),e("span",{class:"text-blue-400"},"<div"),s(),e("span",{class:"text-green-400"},"className="),e("span",{class:"text-red-400"},'"post-actions"'),e("span",{class:"text-blue-400"},">"),s(`
      {canEdit && `),e("span",{class:"text-blue-400"},"<button"),s(),e("span",{class:"text-green-400"},"onClick="),e("span",{class:"text-yellow-400"},"{editPost}"),e("span",{class:"text-blue-400"},">"),s("Edit"),e("span",{class:"text-blue-400"},"</button>"),s(`}
      {canDelete && `),e("span",{class:"text-blue-400"},"<button"),s(),e("span",{class:"text-green-400"},"onClick="),e("span",{class:"text-yellow-400"},"{deletePost}"),e("span",{class:"text-blue-400"},">"),s("Delete"),e("span",{class:"text-blue-400"},"</button>"),s(`}
    `),e("span",{class:"text-blue-400"},"</div>"),s(`
  )
}`)])],-1))])])])])]),_:1}),n(p,{color:"emerald",variant:"soft",title:"🔐 Complete Authorization System!",description:"Base Framework's authorization module provides enterprise-grade RBAC with middleware protection, API endpoints for role management, and seamless frontend integration for permission checking."})])]),e("section",null,[t[199]||(t[199]=e("h2",{class:"text-3xl font-bold text-gray-900 dark:text-white mb-6"},"Integration Examples",-1)),e("div",hs,[n(i,null,{header:a(()=>[e("div",ks,[n(r,{name:"i-lucide-code",class:"h-4 w-4 text-blue-500"}),t[195]||(t[195]=e("span",{class:"font-semibold"},"Protecting Generated Modules",-1))])]),default:a(()=>[e("div",vs,[t[198]||(t[198]=e("p",{class:"text-sm text-gray-600 dark:text-gray-300"}," When you generate modules with Base Framework, you can easily add authentication to protect your endpoints: ",-1)),e("div",ws,[e("div",Ps,[t[196]||(t[196]=e("span",{class:"text-xs text-gray-400"},"Generated Controller with Auth",-1)),e("button",{class:"copy-button text-xs text-gray-400 hover:text-gray-200 px-2 py-1 rounded border border-gray-600 hover:border-gray-400 transition-colors",onClick:t[18]||(t[18]=o=>l(`func (c *PostController) Routes(router *router.RouterGroup) {
  // Public endpoints (no auth required)
  router.GET("/posts", c.List)                    // Public post listing
  router.GET("/posts/:id", c.Get)               // Public post view
  
  // Protected endpoints - using new intuitive syntax
  router.POST("/posts", c.Create, authorization.Can("create", "Post"))
  router.PUT("/posts/:id", c.Update, authorization.CanAccess("update", "Post", "id"))
  router.DELETE("/posts/:id", c.Delete, authorization.CanAccess("delete", "Post", "id"))
  
  // Admin endpoints (role-based protection)
  adminGroup := router.Group("/admin/posts", authorization.HasRole("Administrator"))
  {
    adminGroup.DELETE("/:id", c.ForceDelete)      // Admin force delete
    adminGroup.PUT("/:id/featured", c.SetFeatured) // Admin feature post
    adminGroup.POST("/bulk-delete", c.BulkDelete)  // Admin bulk operations
  }
  
  // Mixed protection: role + permission
  router.POST("/posts/publish", c.PublishPost,
    authorization.HasRole("Member"),
    authorization.Can("publish", "Post"))
}`,o))}," Copy ")]),t[197]||(t[197]=e("pre",{class:"text-sm text-gray-300 whitespace-pre-wrap"},[e("code",null,[e("span",{class:"text-blue-400"},"func"),s(" (c *PostController) "),e("span",{class:"text-yellow-400"},"Routes"),s(`(router *router.RouterGroup) {
  `),e("span",{class:"text-green-400"},"// Public endpoints (no auth required)"),s(`
  router.GET(`),e("span",{class:"text-red-400"},'"/posts"'),s(", c.List)                    "),e("span",{class:"text-green-400"},"// Public post listing"),s(`
  router.GET(`),e("span",{class:"text-red-400"},'"/posts/:id"'),s(", c.Get)               "),e("span",{class:"text-green-400"},"// Public post view"),s(`
  
  `),e("span",{class:"text-green-400"},"// Protected endpoints - using new intuitive syntax"),s(`
  router.POST(`),e("span",{class:"text-red-400"},'"/posts"'),s(", c.Create, "),e("span",{class:"text-purple-400"},'authorization.Can("create", "Post")'),s(`)
  router.PUT(`),e("span",{class:"text-red-400"},'"/posts/:id"'),s(", c.Update, "),e("span",{class:"text-purple-400"},'authorization.CanAccess("update", "Post", "id")'),s(`)
  router.DELETE(`),e("span",{class:"text-red-400"},'"/posts/:id"'),s(", c.Delete, "),e("span",{class:"text-purple-400"},'authorization.CanAccess("delete", "Post", "id")'),s(`)
  
  `),e("span",{class:"text-green-400"},"// Admin endpoints (role-based protection)"),s(`
  adminGroup := router.Group(`),e("span",{class:"text-red-400"},'"/admin/posts"'),s(", "),e("span",{class:"text-purple-400"},'authorization.HasRole("Administrator")'),s(`)
  {
    adminGroup.DELETE(`),e("span",{class:"text-red-400"},'"/:id"'),s(", c.ForceDelete)      "),e("span",{class:"text-green-400"},"// Admin force delete"),s(`
    adminGroup.PUT(`),e("span",{class:"text-red-400"},'"/:id/featured"'),s(", c.SetFeatured) "),e("span",{class:"text-green-400"},"// Admin feature post"),s(`
    adminGroup.POST(`),e("span",{class:"text-red-400"},'"/bulk-delete"'),s(", c.BulkDelete)  "),e("span",{class:"text-green-400"},"// Admin bulk operations"),s(`
  }
  
  `),e("span",{class:"text-green-400"},"// Mixed protection: role + permission"),s(`
  router.POST(`),e("span",{class:"text-red-400"},'"/posts/publish"'),s(`, c.PublishPost,
    `),e("span",{class:"text-purple-400"},'authorization.HasRole("Member")'),s(`,
    `),e("span",{class:"text-purple-400"},'authorization.Can("publish", "Post")'),s(`)
}`)])],-1))])])]),_:1}),n(p,{color:"green",variant:"soft",title:"🎉 Complete Authentication Solution!",description:"Base Framework's core authentication modules provide everything you need for secure user management, from social login to enterprise-grade authorization - all built-in and ready to use!"})])])])])),[[y]])]),_:1})}}});export{zs as default};
